"use strict";(()=>{var e={};e.id=3270,e.ids=[3270],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},61212:e=>{e.exports=require("async_hooks")},78893:e=>{e.exports=require("buffer")},3199:e=>{e.exports=require("console")},84770:e=>{e.exports=require("crypto")},27920:e=>{e.exports=require("diagnostics_channel")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},32694:e=>{e.exports=require("http2")},98216:e=>{e.exports=require("net")},96119:e=>{e.exports=require("perf_hooks")},86624:e=>{e.exports=require("querystring")},76162:e=>{e.exports=require("stream")},66083:e=>{e.exports=require("stream/web")},74026:e=>{e.exports=require("string_decoder")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},61814:e=>{e.exports=require("util/types")},6162:e=>{e.exports=require("worker_threads")},71568:e=>{e.exports=require("zlib")},6005:e=>{e.exports=require("node:crypto")},15673:e=>{e.exports=require("node:events")},87561:e=>{e.exports=require("node:fs")},49411:e=>{e.exports=require("node:path")},84492:e=>{e.exports=require("node:stream")},47261:e=>{e.exports=require("node:util")},44083:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>q,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>x,staticGenerationAsyncStorage:()=>l});var i={};r.r(i),r.d(i,{POST:()=>u});var s=r(49303),n=r(88716),o=r(60670),a=r(24910),p=r(85053);async function u(e){let t=await (0,a.I)();if(!t.userId)return new Response("Unauthorized",{status:401});if(!(process.env.ADMIN_ALLOWLIST||"").split(",").map(e=>e.trim()).filter(Boolean).includes(t.userId))return new Response("Forbidden",{status:403});let{userId:r,tier:i,status:s}=await e.json().catch(()=>({}));return r&&i?(await (0,p.gB)(r,i,s||"active"),new Response(JSON.stringify({ok:!0}),{headers:{"Content-Type":"application/json"}})):new Response("Missing params",{status:400})}let c=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/set-tier/route",pathname:"/api/admin/set-tier",filename:"route",bundlePath:"app/api/admin/set-tier/route"},resolvedPagePath:"/Users/home/dev/ABA-tool/app/api/admin/set-tier/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:x}=c,f="/api/admin/set-tier/route";function q(){return(0,o.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:l})}},85053:(e,t,r)=>{r.d(t,{dC:()=>o,gB:()=>a,lX:()=>p});var i=r(12757);function s(e){return`billing/users/${e}.json`}function n(e){return`billing/orgs/${e}.json`}async function o(e,t){if(t){let e=n(t),r=(await (0,i.pb)({prefix:e})).blobs.find(t=>t.pathname===e);if(r)try{let e=await fetch(r.url),t=await e.json();if(t?.status==="active"&&"string"==typeof t?.tier)return t.tier}catch{}}let r=s(e),o=(await (0,i.pb)({prefix:r})).blobs.find(e=>e.pathname===r);if(!o)return"free";try{let e=await fetch(o.url),t=await e.json();if(t?.status==="active"&&"string"==typeof t?.tier)return t.tier}catch{}return"free"}async function a(e,t,r="active",n){let o={tier:t,status:r,updatedAt:Date.now(),orgId:n};await (0,i.gz)(s(e),JSON.stringify(o),{access:"public",contentType:"application/json",addRandomSuffix:!1})}async function p(e,t,r="active"){let s={tier:t,status:r,updatedAt:Date.now(),orgId:e};await (0,i.gz)(n(e),JSON.stringify(s),{access:"public",contentType:"application/json",addRandomSuffix:!1})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[8948,4910,6842],()=>r(44083));module.exports=i})();