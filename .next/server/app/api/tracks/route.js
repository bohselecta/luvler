"use strict";(()=>{var e={};e.id=6855,e.ids=[6855],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},61212:e=>{e.exports=require("async_hooks")},78893:e=>{e.exports=require("buffer")},3199:e=>{e.exports=require("console")},84770:e=>{e.exports=require("crypto")},27920:e=>{e.exports=require("diagnostics_channel")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},32694:e=>{e.exports=require("http2")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},55315:e=>{e.exports=require("path")},96119:e=>{e.exports=require("perf_hooks")},68621:e=>{e.exports=require("punycode")},86624:e=>{e.exports=require("querystring")},76162:e=>{e.exports=require("stream")},66083:e=>{e.exports=require("stream/web")},74026:e=>{e.exports=require("string_decoder")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},61814:e=>{e.exports=require("util/types")},6162:e=>{e.exports=require("worker_threads")},71568:e=>{e.exports=require("zlib")},6005:e=>{e.exports=require("node:crypto")},15673:e=>{e.exports=require("node:events")},87561:e=>{e.exports=require("node:fs")},49411:e=>{e.exports=require("node:path")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},47261:e=>{e.exports=require("node:util")},52969:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>q,requestAsyncStorage:()=>y,routeModule:()=>x,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h});var i={};r.r(i),r.d(i,{POST:()=>f,dynamic:()=>l,runtime:()=>d});var n=r(49303),a=r(88716),s=r(60670),o=r(24910),u=r(72441),p=r(85053),c=r(73966);let d="nodejs",l="force-dynamic";async function f(e){let{slug:t="illustration"}=await e.json().catch(()=>({}));try{let e=await (0,o.I)();if(e.userId){let t=await (0,p.dC)(e.userId,e.orgId),r=(0,u.Ti)(t),i=await (0,u.X9)(e.userId);if(i.used>=r)return new Response(JSON.stringify({ok:!1,error:"limit_exceeded",limit:r,used:i.used}),{status:429,headers:{"Content-Type":"application/json"}})}}catch{}if(process.env.ANTHROPIC_API_KEY)try{let e=new c.ZP({apiKey:process.env.ANTHROPIC_API_KEY}),r=`Design a concise 5-step learning outline for topic "${t}". Use plain language and progressive scaffolding. Output JSON: {"outline":[{"id":"a","title":"..."}, ...]}`,i=await e.messages.create({model:process.env.ANTHROPIC_MODEL_HAIKU||"claude-3-haiku-20240307",max_tokens:250,temperature:.3,messages:[{role:"user",content:r}]}),n=i.content[0]?.text||"{}",a=JSON.parse(n);if(a?.outline?.length){try{let e=await (0,o.I)();e.userId&&await (0,u.iS)(e.userId,1)}catch{}return new Response(JSON.stringify({ok:!0,slug:t,outline:a.outline}),{headers:{"Content-Type":"application/json"}})}}catch(e){}try{let e=await (0,o.I)();e.userId&&await (0,u.iS)(e.userId,1)}catch{}return new Response(JSON.stringify({ok:!0,slug:t,outline:[{id:"a",title:"Gather 5 references"},{id:"b",title:"Copy one for line confidence"},{id:"c",title:"Gesture practice: 10\xd7 30s"},{id:"d",title:"1 study with shading"},{id:"e",title:"Share with 1 friend for feedback"}]}),{headers:{"Content-Type":"application/json"}})}let x=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/tracks/route",pathname:"/api/tracks",filename:"route",bundlePath:"app/api/tracks/route"},resolvedPagePath:"/Users/home/dev/ABA-tool/app/api/tracks/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:y,staticGenerationAsyncStorage:h,serverHooks:g}=x,m="/api/tracks/route";function q(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}},72441:(e,t,r)=>{r.d(t,{Ti:()=>s,iS:()=>p,X9:()=>o});var i=r(12757);let n=[{id:"free",name:"Discovery",priceMonthly:0,analysesPerMonth:5,features:["1 saved plan","Community resources"]},{id:"individual",name:"Individual",priceMonthly:9,analysesPerMonth:50,features:["5 active plans","Export & share"]},{id:"clinician",name:"Clinician",priceMonthly:29,analysesPerMonth:300,features:["Client folders","Templates","CSV export"]},{id:"clinic",name:"Clinic / Team",priceMonthly:119,analysesPerMonth:1500,seats:5,features:["Pooled usage","Roles & permissions"]},{id:"enterprise",name:"Enterprise",priceMonthly:"contact",features:["SSO","BAA addendum","Priority support"]}];function a(e=new Date){let t=e.getUTCFullYear(),r=String(e.getUTCMonth()+1).padStart(2,"0");return`${t}-${r}`}function s(e){let t=n.find(t=>t.id===e);return t?t.analysesPerMonth??5:5}async function o(e){let t=a(),r=`usage/${t}/${e}.json`,{blobs:n}=await (0,i.pb)({prefix:r}),s=n.find(e=>e.pathname===r);if(!s)return{used:0,updatedAt:Date.now()};try{let e=await fetch(s.url),t=await e.json();return{used:Number(t.used||0),updatedAt:Number(t.updatedAt||Date.now())}}catch{return{used:0,updatedAt:Date.now()}}}async function u(e,t){let r=a(),n=`usage/${r}/${e}.json`;await (0,i.gz)(n,JSON.stringify(t),{access:"public",contentType:"application/json",addRandomSuffix:!1})}async function p(e,t=1){let r={used:(await o(e)).used+t,updatedAt:Date.now()};return await u(e,r),r}},85053:(e,t,r)=>{r.d(t,{dC:()=>s,gB:()=>o,lX:()=>u});var i=r(12757);function n(e){return`billing/users/${e}.json`}function a(e){return`billing/orgs/${e}.json`}async function s(e,t){if(t){let e=a(t),r=(await (0,i.pb)({prefix:e})).blobs.find(t=>t.pathname===e);if(r)try{let e=await fetch(r.url),t=await e.json();if(t?.status==="active"&&"string"==typeof t?.tier)return t.tier}catch{}}let r=n(e),s=(await (0,i.pb)({prefix:r})).blobs.find(e=>e.pathname===r);if(!s)return"free";try{let e=await fetch(s.url),t=await e.json();if(t?.status==="active"&&"string"==typeof t?.tier)return t.tier}catch{}return"free"}async function o(e,t,r="active",a){let s={tier:t,status:r,updatedAt:Date.now(),orgId:a};await (0,i.gz)(n(e),JSON.stringify(s),{access:"public",contentType:"application/json",addRandomSuffix:!1})}async function u(e,t,r="active"){let n={tier:t,status:r,updatedAt:Date.now(),orgId:e};await (0,i.gz)(a(e),JSON.stringify(n),{access:"public",contentType:"application/json",addRandomSuffix:!1})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[8948,4910,6842,3966],()=>r(52969));module.exports=i})();