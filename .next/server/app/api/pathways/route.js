"use strict";(()=>{var e={};e.id=1525,e.ids=[1525],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},61212:e=>{e.exports=require("async_hooks")},78893:e=>{e.exports=require("buffer")},3199:e=>{e.exports=require("console")},84770:e=>{e.exports=require("crypto")},27920:e=>{e.exports=require("diagnostics_channel")},17702:e=>{e.exports=require("events")},92048:e=>{e.exports=require("fs")},32615:e=>{e.exports=require("http")},32694:e=>{e.exports=require("http2")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},55315:e=>{e.exports=require("path")},96119:e=>{e.exports=require("perf_hooks")},68621:e=>{e.exports=require("punycode")},86624:e=>{e.exports=require("querystring")},76162:e=>{e.exports=require("stream")},66083:e=>{e.exports=require("stream/web")},74026:e=>{e.exports=require("string_decoder")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},61814:e=>{e.exports=require("util/types")},6162:e=>{e.exports=require("worker_threads")},71568:e=>{e.exports=require("zlib")},6005:e=>{e.exports=require("node:crypto")},15673:e=>{e.exports=require("node:events")},87561:e=>{e.exports=require("node:fs")},49411:e=>{e.exports=require("node:path")},84492:e=>{e.exports=require("node:stream")},72477:e=>{e.exports=require("node:stream/web")},47261:e=>{e.exports=require("node:util")},83442:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>b,patchFetch:()=>q,requestAsyncStorage:()=>x,routeModule:()=>y,serverHooks:()=>v,staticGenerationAsyncStorage:()=>w});var r={};s.r(r),s.d(r,{POST:()=>g,dynamic:()=>m,runtime:()=>f});var n=s(49303),i=s(88716),a=s(60670),o=s(24910),c=s(72441),u=s(85053),p=s(73966),l=s(68570);(0,l.createProxy)(String.raw`/Users/home/dev/ABA-tool/lib/personalization.ts#getOnboardingProfile`);let d=(0,l.createProxy)(String.raw`/Users/home/dev/ABA-tool/lib/personalization.ts#getProcessingModalities`),h=(0,l.createProxy)(String.raw`/Users/home/dev/ABA-tool/lib/personalization.ts#getSpecialInterests`);(0,l.createProxy)(String.raw`/Users/home/dev/ABA-tool/lib/personalization.ts#hasEnhancedOnboarding`),(0,l.createProxy)(String.raw`/Users/home/dev/ABA-tool/lib/personalization.ts#saveOnboardingProfile`);let f="nodejs",m="force-dynamic";async function g(e){let{title:t="Make a friend who likes Pokemon",interests:s=["pokemon","games"],processingModalities:r=[],specialInterests:n=[],includeContextualReasons:i=!1}=await e.json().catch(()=>({}));try{let e=await (0,o.I)();if(e.userId){let t=await (0,u.dC)(e.userId,e.orgId),s=(0,c.Ti)(t),r=await (0,c.X9)(e.userId);if(r.used>=s)return new Response(JSON.stringify({ok:!1,error:"limit_exceeded",limit:s,used:r.used}),{status:429,headers:{"Content-Type":"application/json"}})}}catch{}let a="";if((r.length>0||n.length>0)&&(a=" Consider the user's processing style and interests when crafting guidance.",r.includes("narrative")&&(a+=" Use story-based analogies and examples since this person thinks in narratives."),r.includes("visual")&&(a+=" Include visual descriptions and spatial analogies."),r.includes("systematic")&&(a+=" Use logical sequences and cause-effect explanations."),r.includes("kinesthetic")&&(a+=" Include physical actions and hands-on approaches."),n.length>0&&(a+=` Incorporate examples from their interests: ${n.join(", ")}.`)),process.env.ANTHROPIC_API_KEY)try{let e;try{if((await (0,o.I)()).userId){let t=d(),s=h();e={processingModalities:t,specialInterests:s,taskType:"friendship"}}}catch{}let r=new p.ZP({apiKey:process.env.ANTHROPIC_API_KEY}),n=function(e,t,s){let r=s?function(e){let{processingModalities:t=[],specialInterests:s=[],taskType:r}=e,n="";t.includes("narrative")&&(n+=" Use story-based analogies and examples. Frame guidance as narratives with clear beginnings, middles, and ends."),t.includes("visual")&&(n+=" Include visual descriptions and spatial analogies. Describe steps as if drawing a picture or map."),t.includes("systematic")&&(n+=" Use logical sequences and cause-effect explanations. Present information in clear, numbered steps with rationales."),t.includes("numerical")&&(n+=" Include numbers, data, and quantitative approaches. Use measurements, counts, and statistical concepts."),t.includes("kinesthetic")&&(n+=" Include physical actions and hands-on approaches. Describe steps as movements or physical processes."),t.includes("musical")&&(n+=" Use rhythm, melody, and auditory analogies. Present information with patterns and sequences like music."),s.length>0&&(n+=` Incorporate examples and analogies from these interests: ${s.join(", ")}.`);let i="";switch(r){case"self-advocacy":i="Focus on building confidence and self-advocacy skills. Emphasize that the user's pace and comfort level matter most.";break;case"friendship":i="Focus on building social confidence through structured, interest-based connections. Emphasize safety and user autonomy.";break;case"goal-setting":i="Break down goals into small, manageable steps. Celebrate effort and progress, not perfection.";break;default:i="Provide supportive, non-judgmental guidance that respects individual processing styles."}return`${n} ${i}`.trim()}({...s,taskType:"friendship"}):"";return`You are an ABA-informed assistant following BACB ethics: prioritize assent, autonomy, and dignity; avoid coercion or aversives.

Generate a comprehensive 4-phase friendship pathway for the goal "${e}" using interests ${JSON.stringify(t)}.

The 4 phases are:
1. understanding - Explore what friendship means personally (2-3 steps)
2. practice - Build skills through safe exercises (3-4 steps)
3. opportunities - Find structured social connections (2-3 steps)
4. confidence - Track progress and celebrate growth (2-3 steps)

Each step should include:
- A contextualReason explaining why this step matters in the immediate context
- Practical, actionable instructions
- Tips for different comfort levels

${r}

Output STRICT JSON: {"steps":[{"id":"phase_step","order":1,"phase":"understanding","instruction":"Clear instruction","tip":"Helpful tip","contextualReason":"Why this matters now"}]}`}(t,s,e),i=await r.messages.create({model:process.env.ANTHROPIC_MODEL_HAIKU||"claude-3-haiku-20240307",max_tokens:1500,temperature:.4,messages:[{role:"user",content:n}]}),a=i.content[0]?.text||"{}",u=JSON.parse(a);if(u?.steps?.length){try{let e=await (0,o.I)();e.userId&&await (0,c.iS)(e.userId,1)}catch{}return new Response(JSON.stringify({ok:!0,title:t,steps:u.steps}),{headers:{"Content-Type":"application/json"}})}}catch(e){console.warn("AI pathway generation failed:",e)}let l=[{id:"understanding_1",order:1,phase:"understanding",instruction:`Spend 5 minutes thinking about what friendship means to you, using examples from ${s[0]||"your interests"}`,tip:"There's no right answer - this is just for you to explore",...i&&{contextualReason:"This helps you understand friendship on your own terms"}},{id:"understanding_2",order:2,phase:"understanding",instruction:"Write down 3 qualities you value in potential friends",tip:"Focus on what feels important to you personally",...i&&{contextualReason:"This clarifies what you're looking for in connections"}},{id:"practice_1",order:3,phase:"practice",instruction:`Practice a simple conversation starter about ${s[0]||"an interest"} in front of a mirror`,tip:"Start small and build confidence gradually",...i&&{contextualReason:"This builds comfort with social skills in a low-pressure way"}},{id:"practice_2",order:4,phase:"practice",instruction:"Role-play a short greeting with a trusted person or pet",tip:"Practice makes the real thing feel more familiar",...i&&{contextualReason:"This creates positive associations with social interactions"}},{id:"practice_3",order:5,phase:"practice",instruction:"Write down one thing you did well in each practice attempt",tip:"Focus on effort and small successes",...i&&{contextualReason:"This builds confidence by recognizing your progress"}},{id:"opportunities_1",order:6,phase:"opportunities",instruction:`Look for a ${s[0]||"special interest"} group or meetup in your area or online`,tip:"Start with virtual options if in-person feels overwhelming",...i&&{contextualReason:"This connects you with people who already share your interests"}},{id:"opportunities_2",order:7,phase:"opportunities",instruction:'Set one small personal goal for your first meetup (like "say hello to one person")',tip:"Keep goals achievable and focused on showing up",...i&&{contextualReason:"This makes the experience feel manageable and success-focused"}},{id:"confidence_1",order:8,phase:"confidence",instruction:"After any social attempt, write down one thing you're proud of",tip:"Include both big and small achievements",...i&&{contextualReason:"This celebrates your courage and builds positive momentum"}},{id:"confidence_2",order:9,phase:"confidence",instruction:"Notice how your comfort level changes over time",tip:"Progress might not be linear - that's okay",...i&&{contextualReason:"This helps you see your growth and build self-trust"}}];try{let e=await (0,o.I)();e.userId&&await (0,c.iS)(e.userId,1)}catch{}return new Response(JSON.stringify({ok:!0,title:t,steps:l}),{headers:{"Content-Type":"application/json"}})}let y=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/pathways/route",pathname:"/api/pathways",filename:"route",bundlePath:"app/api/pathways/route"},resolvedPagePath:"/Users/home/dev/ABA-tool/app/api/pathways/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:x,staticGenerationAsyncStorage:w,serverHooks:v}=y,b="/api/pathways/route";function q(){return(0,a.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:w})}},72441:(e,t,s)=>{s.d(t,{Ti:()=>a,iS:()=>u,X9:()=>o});var r=s(12757);let n=[{id:"free",name:"Discovery",priceMonthly:0,analysesPerMonth:5,features:["1 saved plan","Community resources"]},{id:"individual",name:"Individual",priceMonthly:9,analysesPerMonth:50,features:["5 active plans","Export & share"]},{id:"clinician",name:"Clinician",priceMonthly:29,analysesPerMonth:300,features:["Client folders","Templates","CSV export"]},{id:"clinic",name:"Clinic / Team",priceMonthly:119,analysesPerMonth:1500,seats:5,features:["Pooled usage","Roles & permissions"]},{id:"enterprise",name:"Enterprise",priceMonthly:"contact",features:["SSO","BAA addendum","Priority support"]}];function i(e=new Date){let t=e.getUTCFullYear(),s=String(e.getUTCMonth()+1).padStart(2,"0");return`${t}-${s}`}function a(e){let t=n.find(t=>t.id===e);return t?t.analysesPerMonth??5:5}async function o(e){let t=i(),s=`usage/${t}/${e}.json`,{blobs:n}=await (0,r.pb)({prefix:s}),a=n.find(e=>e.pathname===s);if(!a)return{used:0,updatedAt:Date.now()};try{let e=await fetch(a.url),t=await e.json();return{used:Number(t.used||0),updatedAt:Number(t.updatedAt||Date.now())}}catch{return{used:0,updatedAt:Date.now()}}}async function c(e,t){let s=i(),n=`usage/${s}/${e}.json`;await (0,r.gz)(n,JSON.stringify(t),{access:"public",contentType:"application/json",addRandomSuffix:!1})}async function u(e,t=1){let s={used:(await o(e)).used+t,updatedAt:Date.now()};return await c(e,s),s}},85053:(e,t,s)=>{s.d(t,{dC:()=>a,gB:()=>o,lX:()=>c});var r=s(12757);function n(e){return`billing/users/${e}.json`}function i(e){return`billing/orgs/${e}.json`}async function a(e,t){if(t){let e=i(t),s=(await (0,r.pb)({prefix:e})).blobs.find(t=>t.pathname===e);if(s)try{let e=await fetch(s.url),t=await e.json();if(t?.status==="active"&&"string"==typeof t?.tier)return t.tier}catch{}}let s=n(e),a=(await (0,r.pb)({prefix:s})).blobs.find(e=>e.pathname===s);if(!a)return"free";try{let e=await fetch(a.url),t=await e.json();if(t?.status==="active"&&"string"==typeof t?.tier)return t.tier}catch{}return"free"}async function o(e,t,s="active",i){let a={tier:t,status:s,updatedAt:Date.now(),orgId:i};await (0,r.gz)(n(e),JSON.stringify(a),{access:"public",contentType:"application/json",addRandomSuffix:!1})}async function c(e,t,s="active"){let n={tier:t,status:s,updatedAt:Date.now(),orgId:e};await (0,r.gz)(i(e),JSON.stringify(n),{access:"public",contentType:"application/json",addRandomSuffix:!1})}},68570:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createProxy",{enumerable:!0,get:function(){return r}});let r=s(51749).createClientModuleProxy},51749:(e,t,s)=>{e.exports=s(23191).vendored["react-rsc"].ReactServerDOMWebpackServerEdge}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[8948,4910,6842,3966],()=>s(83442));module.exports=r})();